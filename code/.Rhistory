library(rio)
library(dplyr)
library(stringr)
library(tidyr)
EG2021 <- import("/Users/alexander/Documents/boyco-benites/data/raw/Resultados_1ra_vuelta_Version_PCM.csv")
# Step 2: Set correct column names (omit the last empty column)
correct_names <- c(
"UBIGEO", "DEPARTAMENTO", "PROVINCIA", "DISTRITO", "TIPO_ELECCION",
"MESA_DE_VOTACION", "DESCRIP_ESTADO_ACTA", "TIPO_OBSERVACION", "N_CVAS",
"N_ELEC_HABIL", "VOTOS_P1", "VOTOS_P2", "VOTOS_P3", "VOTOS_P4", "VOTOS_P5",
"VOTOS_P6", "VOTOS_P7", "VOTOS_P8", "VOTOS_P9", "VOTOS_P10", "VOTOS_P11",
"VOTOS_P12", "VOTOS_P13", "VOTOS_P14", "VOTOS_P15", "VOTOS_P16", "VOTOS_P17",
"VOTOS_P18", "VOTOS_VB", "VOTOS_VN", "VOTOS_VI"
)
# Step 3: Drop the last column (which is empty)
EG2021 <- EG2021[, 1:31]
# Step 4: Apply the correct names
names(EG2021) <- correct_names
# Selected cols: Null and blank votes
dataEG21 <- EG2021 %>% select(1:4,9,10,29,30) %>% # Only relevant features
group_by(UBIGEO,DEPARTAMENTO, PROVINCIA, DISTRITO) %>%  # Group and sum by district
summarise(across(where(is.numeric), \(x) sum(x, na.rm = TRUE)), .groups = "drop") %>%
# Adding zeros:
mutate(UBIGEO = ifelse(nchar(UBIGEO) == 5, str_pad(UBIGEO, 6, pad = "0"), UBIGEO))
# Changing col names
colnames(dataEG21) <- c("UBIGEO", "DEPARTAMENTO", "PROVINCIA", "DISTRITO", "TOTAL_VOTOS",
"ELECTORES_HAB","V_BLANCOS","V_NULOS")
# Calculating frequencies based on total registered votes
dataEG21$AUSENTISMO <- 1-round(dataEG21$TOTAL_VOTOS/dataEG21$ELECTORES_HAB,2) # Turnout
dataEG21$FreqBLANCOS <- round(dataEG21$V_BLANCOS/dataEG21$TOTAL_VOTOS,2) # Blank votes
dataEG21$FreqNULOS <- round(dataEG21$V_NULOS/dataEG21$TOTAL_VOTOS,2) # Null votes
dataEG21$FreqINVALIDOS = dataEG21$FreqBLANCOS + dataEG21$FreqNULOS # Invalid votes
# Last steps:
dataEG21$YEAR = 2021
dataEG21$TYPE = "PRESIDENCIAL"
EG2021C <- import("/Users/alexander/Documents/boyco-benites/data/raw/EG2021_Congresal.csv")
# Separate total number of electors and total number of votes because of complicated data structure
d <- EG2021C %>%
select("UBIGEO", "DEPARTAMENTO", "PROVINCIA", "DISTRITO","MESA_DE_VOTACION","N_CVAS",
"N_ELEC_HABIL") %>% # Adding zeros:
mutate(UBIGEO = ifelse(nchar(UBIGEO) == 5, str_pad(UBIGEO, 6, pad = "0"), UBIGEO)) %>%
distinct()
d <- d %>% select(-MESA_DE_VOTACION) %>%
group_by(UBIGEO,DEPARTAMENTO, PROVINCIA, DISTRITO) %>%  # Group and sum by district
summarise(across(where(is.numeric), \(x) sum(x, na.rm = TRUE)), .groups = "drop")
# d has both variables for aggregated by district
dataEG21C <- EG2021C %>%
select("UBIGEO", "DEPARTAMENTO", "PROVINCIA", "DISTRITO","DESCRIPCION_OP","N_TOTAL_VOTOS",
"MESA_DE_VOTACION") %>%
# Only relevant categories
filter(DESCRIPCION_OP %in% c("VOTOS EN BLANCO", "VOTOS NULOS")) %>%
# Adding zeros
mutate(UBIGEO = ifelse(nchar(UBIGEO) == 5, str_pad(UBIGEO, 6, pad = "0"), UBIGEO)) %>%
# Sum values
group_by(UBIGEO, DEPARTAMENTO, PROVINCIA, DISTRITO, DESCRIPCION_OP) %>%
# Data wrangling
summarise(VOTOS= sum(N_TOTAL_VOTOS, na.rm = TRUE)) %>%
pivot_wider(
names_from = DESCRIPCION_OP,
values_from = VOTOS)
# Combine the two tables:
d <- d[,c(1,5,6)] # Avoiding duplication
dataEG21C <- merge(dataEG21C, d, by = "UBIGEO", all.x = TRUE) # Merge
# Changing col names
colnames(dataEG21C) <- c("UBIGEO", "DEPARTAMENTO", "PROVINCIA", "DISTRITO",
"V_BLANCOS","V_NULOS","TOTAL_VOTOS","ELECTORES_HAB")
# Calculations
dataEG21C$AUSENTISMO <- 1 - round(dataEG21C$TOTAL_VOTOS / dataEG21C$ELECTORES_HAB,2) #Turnout
dataEG21C$FreqBLANCOS <- round(dataEG21C$V_BLANCOS / dataEG21C$TOTAL_VOTOS, 2) #Blank
dataEG21C$FreqNULOS <- round(dataEG21C$V_NULOS / dataEG21C$TOTAL_VOTOS, 2) #Null
dataEG21C$FreqINVALIDOS <- dataEG21C$FreqBLANCOS + dataEG21C$FreqNULOS #Invalid
# Last steps:
dataEG21C$YEAR = 2021
dataEG21C$TYPE = "CONGRESAL"
View(dataEG21C)
export(dataEG21, "presidenciales-2021.csv")
export(dataEG21C, "congresales-2021.csv")
export(dataEG21, "presidenciales-2021.csv")
export(dataEG21C, "congresales-2021.csv")
library(rio)
library(dplyr)
library(stringr)
library(tidyr)
dataEG16 <- import("/Users/alexander/Documents/boyco-benites/data/raw/2016_EG2016_Presidencial.csv")
View(dataEG16)
EG2016 <- import("/Users/alexander/Documents/boyco-benites/data/raw/2016_EG2016_Presidencial.csv")
names(EG2016)
dataEG16 <- EG2016 %>% select(1:4,9,10,25,26)
View(dataEG16)
dataEG16 <- EG2016 %>% select(1:4,9,10,25,26) %>% # Only relevant features
group_by(UBIGEO,DEPARTAMENTO, PROVINCIA, DISTRITO) %>%  # Group and sum by district
summarise(across(where(is.numeric), \(x) sum(x, na.rm = TRUE)), .groups = "drop") %>%
# Adding zeros:
mutate(UBIGEO = ifelse(nchar(UBIGEO) == 5, str_pad(UBIGEO, 6, pad = "0"), UBIGEO))
View(EG2016)
View(dataEG16)
# Changing col names
colnames(dataEG16) <- c("UBIGEO", "DEPARTAMENTO", "PROVINCIA", "DISTRITO", "TOTAL_VOTOS",
"ELECTORES_HAB","V_BLANCOS","V_NULOS")
# Calculating frequencies based on total registered votes
dataEG16$AUSENTISMO <- 1-round(dataEG16$TOTAL_VOTOS / dataEG16$ELECTORES_HAB,2) # Turnout
dataEG16$FreqBLANCOS <- round(dataEG16$V_BLANCOS/dataEG16$TOTAL_VOTOS,2) # Blank votes
dataEG16$FreqNULOS <- round(dataEG16$V_NULOS/dataEG16$TOTAL_VOTOS,2) # Null votes
dataEG16$FreqINVALIDOS = dataEG16$FreqBLANCOS + dataEG16$FreqNULOS # Invalid votes
# Last steps:
dataEG16$YEAR = 2016
dataEG16$TYPE = "PRESIDENCIAL"
export(dataEG16, "presidenciales-2016.csv")
EG2016C <- import("/Users/alexander/Documents/boyco-benites/data/raw/2016_EG2016_Congresal.csv")
View(EG2016C)
View(EG2016C)
names(EG2016C)
# Separate total number of electors and total number of votes because of complicated data structure
d <- EG2016C %>%
select("UBIGEO", "DEPARTAMENTO", "PROVINCIA", "DISTRITO","MESA_DE_VOTACION","N_CVAS",
"N_ELEC_HABIL") %>% # Adding zeros:
mutate(UBIGEO = ifelse(nchar(UBIGEO) == 5, str_pad(UBIGEO, 6, pad = "0"), UBIGEO)) %>%
distinct() # Unique cases
View(d)
d <- d %>% select(-MESA_DE_VOTACION) %>%
group_by(UBIGEO,DEPARTAMENTO, PROVINCIA, DISTRITO) %>%  # Group and sum by district
summarise(across(where(is.numeric), \(x) sum(x, na.rm = TRUE)), .groups = "drop")
dataEG16C <- EG2016C %>%
select("UBIGEO", "DEPARTAMENTO", "PROVINCIA", "DISTRITO","DESCRIPCION_OP","N_TOTAL_VOTOS",
"MESA_DE_VOTACION") %>%
# Only relevant categories
filter(DESCRIPCION_OP %in% c("VOTOS EN BLANCO", "VOTOS NULOS")) %>%
# Adding zeros
mutate(UBIGEO = ifelse(nchar(UBIGEO) == 5, str_pad(UBIGEO, 6, pad = "0"), UBIGEO)) %>%
# Sum values
group_by(UBIGEO, DEPARTAMENTO, PROVINCIA, DISTRITO, DESCRIPCION_OP) %>%
# Data wrangling
summarise(VOTOS= sum(N_TOTAL_VOTOS, na.rm = TRUE)) %>%
pivot_wider(
names_from = DESCRIPCION_OP,
values_from = VOTOS)
View(dataEG16C)
# Combine the two tables:
d <- d[,c(1,5,6)] # Avoiding duplication
dataEG16C <- merge(dataEG16C, d, by = "UBIGEO", all.x = TRUE) # Merge
# Changing col names
colnames(dataEG16C) <- c("UBIGEO", "DEPARTAMENTO", "PROVINCIA", "DISTRITO",
"V_BLANCOS","V_NULOS","TOTAL_VOTOS","ELECTORES_HAB")
# Calculations
dataEG16C$AUSENTISMO <- 1 - round(dataEG16C$TOTAL_VOTOS / dataEG16C$ELECTORES_HAB,2) #Turnout
# Calculations
dataEG16C$AUSENTISMO <- 1 - round(dataEG16C$TOTAL_VOTOS / dataEG16C$ELECTORES_HAB,2) #Turnout
dataEG16C$FreqBLANCOS <- round(dataEG16C$V_BLANCOS / dataEG16C$TOTAL_VOTOS, 2) #Blank
dataEG16C$FreqNULOS <- round(dataEG16C$V_NULOS / dataEG16C$TOTAL_VOTOS, 2) #Null
dataEG16C$FreqINVALIDOS <- dataEG16C$FreqBLANCOS + dataEG16C$FreqNULOS #Invalid
# Last steps:
dataEG16C$YEAR = 2016
dataEG16C$TYPE = "CONGRESAL"
sum(dataEG16C[dataEG16C$DEPARTAMENTO == "AMAZONAS",]$ELECTORES_HAB)
sum(dataEG16C[dataEG16C$DEPARTAMENTO == "AMAZONAS",]$TOTAL_VOTOS)
export(dataEG16C, "congresales-2016.csv")
EG2011 <- import("/Users/alexander/Documents/boyco-benites/data/raw/2011_EG2011_Presidencial.xlsx")
View(EG2011)
names(EG2011)
dataEG11 <- EG2011 %>% select(1:4,9,10,23,24) %>% # Only relevant features
group_by(UBIGEO,DEPARTAMENTO, PROVINCIA, DISTRITO) %>%  # Group and sum by district
summarise(across(where(is.numeric), \(x) sum(x, na.rm = TRUE)), .groups = "drop") %>%
# Adding zeros:
mutate(UBIGEO = ifelse(nchar(UBIGEO) == 5, str_pad(UBIGEO, 6, pad = "0"), UBIGEO))
# Changing col names
colnames(dataEG16) <- c("UBIGEO", "DEPARTAMENTO", "PROVINCIA", "DISTRITO", "TOTAL_VOTOS",
"ELECTORES_HAB","V_BLANCOS","V_NULOS")
# Changing col names
colnames(dataEG11) <- c("UBIGEO", "DEPARTAMENTO", "PROVINCIA", "DISTRITO", "TOTAL_VOTOS",
"ELECTORES_HAB","V_BLANCOS","V_NULOS")
View(dataEG11)
View(dataEG11)
View(EG2011)
dataEG11 <- EG2011 %>% select(1:4,9,10,22,23) %>% # Only relevant features
group_by(UBIGEO,DEPARTAMENTO, PROVINCIA, DISTRITO) %>%  # Group and sum by district
summarise(across(where(is.numeric), \(x) sum(x, na.rm = TRUE)), .groups = "drop") %>%
# Adding zeros:
mutate(UBIGEO = ifelse(nchar(UBIGEO) == 5, str_pad(UBIGEO, 6, pad = "0"), UBIGEO))
# Changing col names
colnames(dataEG11) <- c("UBIGEO", "DEPARTAMENTO", "PROVINCIA", "DISTRITO", "TOTAL_VOTOS",
"ELECTORES_HAB","V_BLANCOS","V_NULOS")
View(dataEG11)
# Calculating frequencies based on total registered votes
dataEG11$AUSENTISMO <- 1-round(dataEG11$TOTAL_VOTOS / dataEG11$ELECTORES_HAB,2) # Turnout
dataEG11$FreqBLANCOS <- round(dataEG11$V_BLANCOS/dataEG11$TOTAL_VOTOS,2) # Blank votes
dataEG11$FreqNULOS <- round(dataEG11$V_NULOS/dataEG11$TOTAL_VOTOS,2) # Null votes
dataEG11$FreqINVALIDOS = dataEG11$FreqBLANCOS + dataEG11$FreqNULOS # Invalid votes
# Last steps:
dataEG11$YEAR = 2011
dataEG11$TYPE = "PRESIDENCIAL"
sum(dataEG11$V_BLANCOS)
export(dataEG11, "presidenciales-2011.csv")
EG2011C <- import("/Users/alexander/Documents/boyco-benites/data/raw/2011_EG2011_Congresal.csv")
View(EG2011C)
names(EG2011C)
# Separate total number of electors and total number of votes because of complicated data structure
d <- EG2011C %>%
select("UBIGEO", "DEPARTAMENTO", "PROVINCIA", "DISTRITO","MESA_DE_VOTACION","N_CVAS",
"N_ELEC_HABIL") %>% # Adding zeros:
mutate(UBIGEO = ifelse(nchar(UBIGEO) == 5, str_pad(UBIGEO, 6, pad = "0"), UBIGEO)) %>%
distinct() # Unique cases
d <- d %>% select(-MESA_DE_VOTACION) %>%
group_by(UBIGEO,DEPARTAMENTO, PROVINCIA, DISTRITO) %>%  # Group and sum by district
summarise(across(where(is.numeric), \(x) sum(x, na.rm = TRUE)), .groups = "drop")
# d has both variables for aggregated by district
View(d)
View(dataEG11)
View(dataEG11)
dataEG11C <- EG2011C %>%
select("UBIGEO", "DEPARTAMENTO", "PROVINCIA", "DISTRITO","DESCRIPCION_OP","N_TOTAL_VOTOS",
"MESA_DE_VOTACION") %>%
# Only relevant categories
filter(DESCRIPCION_OP %in% c("VOTOS EN BLANCO", "VOTOS NULOS")) %>%
# Adding zeros
mutate(UBIGEO = ifelse(nchar(UBIGEO) == 5, str_pad(UBIGEO, 6, pad = "0"), UBIGEO)) %>%
# Sum values
group_by(UBIGEO, DEPARTAMENTO, PROVINCIA, DISTRITO, DESCRIPCION_OP) %>%
# Data wrangling
summarise(VOTOS= sum(N_TOTAL_VOTOS, na.rm = TRUE)) %>%
pivot_wider(
names_from = DESCRIPCION_OP,
values_from = VOTOS)
View(dataEG11C)
dataEG11C <- EG2011C %>%
select("UBIGEO", "DEPARTAMENTO", "PROVINCIA", "DISTRITO","DESCRIPCION_OP","N_TOTAL_VOTOS",
"MESA_DE_VOTACION") %>%
# Only relevant categories
filter(DESCRIPCION_OP %in% c("VOTOS BLANCOS", "VOTOS NULOS")) %>%
# Adding zeros
mutate(UBIGEO = ifelse(nchar(UBIGEO) == 5, str_pad(UBIGEO, 6, pad = "0"), UBIGEO)) %>%
# Sum values
group_by(UBIGEO, DEPARTAMENTO, PROVINCIA, DISTRITO, DESCRIPCION_OP) %>%
# Data wrangling
summarise(VOTOS= sum(N_TOTAL_VOTOS, na.rm = TRUE)) %>%
pivot_wider(
names_from = DESCRIPCION_OP,
values_from = VOTOS)
View(d)
# Combine the two tables:
d <- d[,c(1,5,6)] # Avoiding duplication
dataEG11C <- merge(dataEG11C, d, by = "UBIGEO", all.x = TRUE) # Merge
View(dataEG11C)
# Changing col names
colnames(dataEG11C) <- c("UBIGEO", "DEPARTAMENTO", "PROVINCIA", "DISTRITO",
"V_BLANCOS","V_NULOS","TOTAL_VOTOS","ELECTORES_HAB")
# Calculations
dataEG11C$AUSENTISMO <- 1 - round(dataEG11C$TOTAL_VOTOS / dataEG11C$ELECTORES_HAB,2) #Turnout
dataEG11C$FreqBLANCOS <- round(dataEG11C$V_BLANCOS / dataEG11C$TOTAL_VOTOS, 2) #Blank
dataEG11C$FreqNULOS <- round(dataEG11C$V_NULOS / dataEG11C$TOTAL_VOTOS, 2) #Null
dataEG11C$FreqINVALIDOS <- dataEG11C$FreqBLANCOS + dataEG11C$FreqNULOS #Invalid
# Last steps:
dataEG11C$YEAR = 2011
dataEG11C$TYPE = "CONGRESAL"
sum(dataEG11C[dataEG11C$DEPARTAMENTO == "AMAZONAS",]$V_BLANCOS)
export(dataEG11C, "congresales-2011.csv")
EG2006 <- import("/Users/alexander/Documents/boyco-benites/data/raw/EG2006_Presidencial.csv")
View(EG2006)
names(EG2006)
dataEG06 <- EG2006 %>% select(1:4,9,10,31,32) %>% # Only relevant features
group_by(UBIGEO,DEPARTAMENTO, PROVINCIA, DISTRITO) %>%  # Group and sum by district
summarise(across(where(is.numeric), \(x) sum(x, na.rm = TRUE)), .groups = "drop") %>%
# Adding zeros:
mutate(UBIGEO = ifelse(nchar(UBIGEO) == 5, str_pad(UBIGEO, 6, pad = "0"), UBIGEO))
# Changing col names
colnames(dataEG11) <- c("UBIGEO", "DEPARTAMENTO", "PROVINCIA", "DISTRITO", "TOTAL_VOTOS",
"ELECTORES_HAB","V_BLANCOS","V_NULOS")
# Changing col names
colnames(dataEG06) <- c("UBIGEO", "DEPARTAMENTO", "PROVINCIA", "DISTRITO", "TOTAL_VOTOS",
"ELECTORES_HAB","V_BLANCOS","V_NULOS")
View(EG2006)
View(dataEG06)
# Calculating frequencies based on total registered votes
dataEG06$AUSENTISMO <- 1-round(dataEG06$TOTAL_VOTOS / dataEG06$ELECTORES_HAB,2) # Turnout
dataEG06$FreqBLANCOS <- round(dataEG06$V_BLANCOS/dataEG06$TOTAL_VOTOS,2) # Blank votes
dataEG06$FreqNULOS <- round(dataEG06$V_NULOS/dataEG06$TOTAL_VOTOS,2) # Null votes
dataEG06$FreqINVALIDOS = dataEG06$FreqBLANCOS + dataEG06$FreqNULOS # Invalid votes
# Last steps:
dataEG06$YEAR = 2006
dataEG06$TYPE = "PRESIDENCIAL"
View(dataEG06)
export(dataEG06, "presidenciales-2006.csv")
EG2006C <- import("/Users/alexander/Documents/boyco-benites/data/raw/EG2006_Congresal.csv")
View(EG2006C)
names(EG2006C)
# Separate total number of electors and total number of votes because of complicated data structure
d <- EG2006C %>%
select("UBIGEO", "DEPARTAMENTO", "PROVINCIA", "DISTRITO","MESA_DE_VOTACION","N_CVAS",
"N_ELEC_HABIL") %>% # Adding zeros:
mutate(UBIGEO = ifelse(nchar(UBIGEO) == 5, str_pad(UBIGEO, 6, pad = "0"), UBIGEO)) %>%
distinct() # Unique cases
d <- d %>% select(-MESA_DE_VOTACION) %>%
group_by(UBIGEO,DEPARTAMENTO, PROVINCIA, DISTRITO) %>%  # Group and sum by district
summarise(across(where(is.numeric), \(x) sum(x, na.rm = TRUE)), .groups = "drop")
# d has both variables for aggregated by district
View(d)
View(dataEG06)
dataEG06C <- EG2006C %>%
select("UBIGEO", "DEPARTAMENTO", "PROVINCIA", "DISTRITO","DESCRIPCION_OP","N_TOTAL_VOTOS",
"MESA_DE_VOTACION") %>%
# Only relevant categories
filter(DESCRIPCION_OP %in% c("VOTOS BLANCOS", "VOTOS NULOS")) %>%
# Adding zeros
mutate(UBIGEO = ifelse(nchar(UBIGEO) == 5, str_pad(UBIGEO, 6, pad = "0"), UBIGEO)) %>%
# Sum values
group_by(UBIGEO, DEPARTAMENTO, PROVINCIA, DISTRITO, DESCRIPCION_OP) %>%
# Data wrangling
summarise(VOTOS= sum(N_TOTAL_VOTOS, na.rm = TRUE)) %>%
pivot_wider(
names_from = DESCRIPCION_OP,
values_from = VOTOS)
View(dataEG06C)
View(d)
# Combine the two tables:
d <- d[,c(1,5,6)] # Avoiding duplication
dataEG06C <- merge(dataEG06C, d, by = "UBIGEO", all.x = TRUE) # Merge
# Changing col names
colnames(dataEG06C) <- c("UBIGEO", "DEPARTAMENTO", "PROVINCIA", "DISTRITO",
"V_BLANCOS","V_NULOS","TOTAL_VOTOS","ELECTORES_HAB")
# Calculations
dataEG06C$AUSENTISMO <- 1 - round(dataEG06C$TOTAL_VOTOS / dataEG06C$ELECTORES_HAB,2) #Turnout
dataEG06C$FreqBLANCOS <- round(dataEG06C$V_BLANCOS / dataEG06C$TOTAL_VOTOS, 2) #Blank
dataEG06C$FreqNULOS <- round(dataEG06C$V_NULOS / dataEG06C$TOTAL_VOTOS, 2) #Null
dataEG06C$FreqINVALIDOS <- dataEG06C$FreqBLANCOS + dataEG06C$FreqNULOS #Invalid
# Last steps:
dataEG06C$YEAR = 2006
dataEG06C$TYPE = "CONGRESAL"
export(dataEG06C, "congresales-2006.csv")
EG2001 <- import("/Users/alexander/Documents/boyco-benites/data/raw/Resultados por distrito de las Elecciones Generales - Primera Vuelta.csv")
View(EG2001)
names(EG2001)
dataEG01 <- EG2001 %>% select(1:4,9:12)
View(dataEG01)
dataEG01 <- EG2001 %>% select(1:4,9:12) %>% # Adding zeros:
mutate(UBIGEO = ifelse(nchar(UBIGEO) == 5, str_pad(UBIGEO, 6, pad = "0"), UBIGEO)) %>%
distinct() # Unique cases
View(dataEG01)
names(dataEG01)
dataEG01 <- dataEG01[,c(1,2,3,4,7,8,5,6)]
names(dataEG01)
# Changing col names
colnames(dataEG01) <- c("UBIGEO", "DEPARTAMENTO", "PROVINCIA", "DISTRITO", "TOTAL_VOTOS",
"ELECTORES_HAB","V_BLANCOS","V_NULOS")
dataEG01 <- dataEG01 %>% mutate(across(6:8, as.numeric))
dataEG01 <- EG2001 %>% select(1:4,9:12) %>% # Adding zeros:
mutate(UBIGEO = ifelse(nchar(UBIGEO) == 5, str_pad(UBIGEO, 6, pad = "0"), UBIGEO)) %>%
distinct() # Unique cases
dataEG01 <- dataEG01[,c(1,2,3,4,7,8,5,6)]
# Changing col names
colnames(dataEG01) <- c("UBIGEO", "DEPARTAMENTO", "PROVINCIA", "DISTRITO", "TOTAL_VOTOS",
"ELECTORES_HAB","V_BLANCOS","V_NULOS")
dataEG01 <- dataEG01 %>% mutate(across(6:8, as.numeric))
dataEG01 <- EG2001 %>% select(1:4,9:12) %>% # Adding zeros:
mutate(UBIGEO = ifelse(nchar(UBIGEO) == 5, str_pad(UBIGEO, 6, pad = "0"), UBIGEO)) %>%
distinct() # Unique cases
dataEG01 <- dataEG01[,c(1,2,3,4,7,8,5,6)]
# Changing col names
colnames(dataEG01) <- c("UBIGEO", "DEPARTAMENTO", "PROVINCIA", "DISTRITO", "TOTAL_VOTOS",
"ELECTORES_HAB","V_BLANCOS","V_NULOS")
View(dataEG01)
str(dataEG01)
names(dataEG01)
dataEG01 <- dataEG01 %>% mutate(across(5:8, as.numeric))
dataEG01 <- EG2001 %>% select(1:4,9:12) %>% # Adding zeros:
mutate(UBIGEO = ifelse(nchar(UBIGEO) == 5, str_pad(UBIGEO, 6, pad = "0"), UBIGEO)) %>%
distinct() # Unique cases
dataEG01 <- dataEG01[,c(1,2,3,4,7,8,5,6)]
# Changing col names
colnames(dataEG01) <- c("UBIGEO", "DEPARTAMENTO", "PROVINCIA", "DISTRITO", "TOTAL_VOTOS",
"ELECTORES_HAB","V_BLANCOS","V_NULOS")
dataEG01 <- dataEG01 %>% mutate(across(5:8, ~ as.numeric(gsub(",", "", .))))
dataEG01 <- EG2001 %>% select(1:4,9:12) %>% # Adding zeros:
mutate(UBIGEO = ifelse(nchar(UBIGEO) == 5, str_pad(UBIGEO, 6, pad = "0"), UBIGEO)) %>%
distinct() # Unique cases
dataEG01 <- dataEG01[,c(1,2,3,4,7,8,5,6)]
# Changing col names
colnames(dataEG01) <- c("UBIGEO", "DEPARTAMENTO", "PROVINCIA", "DISTRITO", "TOTAL_VOTOS",
"ELECTORES_HAB","V_BLANCOS","V_NULOS")
dataEG01 <- dataEG01 %>% mutate(across(5:8, ~ as.numeric(gsub(",", "", .))))
View(dataEG01)
# Calculating frequencies based on total registered votes
dataEG01$AUSENTISMO <- 1-round(dataEG01$TOTAL_VOTOS / dataEG01$ELECTORES_HAB,2) # Turnout
dataEG01$FreqBLANCOS <- round(dataEG01$V_BLANCOS/dataEG01$TOTAL_VOTOS,2) # Blank votes
dataEG01$FreqNULOS <- round(dataEG01$V_NULOS/dataEG01$TOTAL_VOTOS,2) # Null votes
dataEG01$FreqINVALIDOS = dataEG01$FreqBLANCOS + dataEG01$FreqNULOS # Invalid votes
# Last steps:
dataEG01$YEAR = 2001
dataEG01$TYPE = "PRESIDENCIAL"
View(dataEG01)
export(dataEG01, "presidenciales-2001.csv")
EG2001C <- import("/Users/alexander/Documents/boyco-benites/data/processed/Resultados por distrito de las Elecciones Congresales.csv")
View(EG2001C)
names(EG2001C)
dataEG01C <- EG2001C %>% select(1:4,9:12) %>% # Adding zeros:
mutate(UBIGEO = ifelse(nchar(UBIGEO) == 5, str_pad(UBIGEO, 6, pad = "0"), UBIGEO)) %>%
distinct() # Unique cases
dataEG01C <- dataEG01C[,c(1,2,3,4,7,8,5,6)]
View(dataEG01C)
View(dataEG01)
# Changing col names
colnames(dataEG01C) <- c("UBIGEO", "DEPARTAMENTO", "PROVINCIA", "DISTRITO", "TOTAL_VOTOS",
"ELECTORES_HAB","V_BLANCOS","V_NULOS")
dataEG01C <- dataEG01C %>% mutate(across(5:8, ~ as.numeric(gsub(",", "", .))))# Deal with comas
# Calculations
dataEG01C$AUSENTISMO <- 1 - round(dataEG01C$TOTAL_VOTOS / dataEG01C$ELECTORES_HAB,2) #Turnout
dataEG01C$FreqBLANCOS <- round(dataEG01C$V_BLANCOS / dataEG01C$TOTAL_VOTOS, 2) #Blank
dataEG01C$FreqNULOS <- round(dataEG01C$V_NULOS / dataEG01C$TOTAL_VOTOS, 2) #Null
dataEG01C$FreqINVALIDOS <- dataEG01C$FreqBLANCOS + dataEG01C$FreqNULOS #Invalid
# Last steps:
dataEG01C$YEAR = 2001
dataEG01C$TYPE = "CONGRESAL"
EG2001C <- import("/Users/alexander/Documents/boyco-benites/data/raw/Resultados por distrito de las Elecciones Congresales.csv")
dataEG01C <- EG2001C %>% select(1:4,9:12) %>% # Adding zeros:
mutate(UBIGEO = ifelse(nchar(UBIGEO) == 5, str_pad(UBIGEO, 6, pad = "0"), UBIGEO)) %>%
distinct() # Unique cases
dataEG01C <- dataEG01C[,c(1,2,3,4,7,8,5,6)]
# Changing col names
colnames(dataEG01C) <- c("UBIGEO", "DEPARTAMENTO", "PROVINCIA", "DISTRITO", "TOTAL_VOTOS",
"ELECTORES_HAB","V_BLANCOS","V_NULOS")
dataEG01C <- dataEG01C %>% mutate(across(5:8, ~ as.numeric(gsub(",", "", .))))# Deal with comas
# Calculations
dataEG01C$AUSENTISMO <- 1 - round(dataEG01C$TOTAL_VOTOS / dataEG01C$ELECTORES_HAB,2) #Turnout
dataEG01C$FreqBLANCOS <- round(dataEG01C$V_BLANCOS / dataEG01C$TOTAL_VOTOS, 2) #Blank
dataEG01C$FreqNULOS <- round(dataEG01C$V_NULOS / dataEG01C$TOTAL_VOTOS, 2) #Null
dataEG01C$FreqINVALIDOS <- dataEG01C$FreqBLANCOS + dataEG01C$FreqNULOS #Invalid
# Last steps:
dataEG01C$YEAR = 2001
dataEG01C$TYPE = "CONGRESAL"
View(dataEG01C)
export(dataEG01C, "congresales-2001.csv")
